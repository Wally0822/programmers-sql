# SELECT

## 🔻 서울에 위치한 식당 목록 출력하기 (Level 4)

``` sql
SELECT
    RR.REST_ID,
    RI.REST_NAME,
    RI.FOOD_TYPE,
    RI.FAVORITES,
    RI.ADDRESS,
    ROUND(AVG(RR.REVIEW_SCORE), 2) AS SCORE
FROM 
    REST_REVIEW AS RR
JOIN 
    REST_INFO AS RI ON RR.REST_ID = RI.REST_ID
WHERE 
    RI.ADDRESS LIKE '서울%'
GROUP BY 
    RR.REST_ID
ORDER BY 
    SCORE DESC,
    RI.FAVORITES DESC;
```

<br>

### 🔻 과일로 만든 아이스크림 고르기 (Level 1)

```sql
SELECT 
    FH.FLAVOR
FROM 
    FIRST_HALF AS FH
JOIN 
    ICECREAM_INFO AS II
    ON FH.FLAVOR = II.FLAVOR
WHERE 
    FH.TOTAL_ORDER > 3000
    AND II.INGREDIENT_TYPE = 'fruit_based'
ORDER BY 
    FH.TOTAL_ORDER DESC;
```


```sql
SELECT FLAVOR
FROM (
    SELECT * 
    FROM FIRST_HALF 
    WHERE TOTAL_ORDER > 3000
) AS FH
JOIN ICECREAM_INFO AS II 
    ON FH.FLAVOR = II.FLAVOR
WHERE II.INGREDIENT_TYPE = 'fruit_based'
ORDER BY FH.TOTAL_ORDER DESC;
```

<br>

### 🔻 평균 일일 대여 요금 구하기

```sql
SELECT ROUND(AVG(DAILY_FEE)) AS AVERAGE_FEE
FROM CAR_RENTAL_COMPANY_CAR
WHERE CAR_TYPE = 'SUV';
```

```sql
SELECT ROUND(avg_fee) AS AVERAGE_FEE
FROM (
  SELECT AVG(DAILY_FEE) AS avg_fee
  FROM CAR_RENTAL_COMPANY_CAR
  WHERE CAR_TYPE = 'SUV'
) AS sub;
```

```sql
SELECT ROUND(AVG(CASE WHEN CAR_TYPE = 'SUV' THEN DAILY_FEE END)) AS AVERAGE_FEE
FROM CAR_RENTAL_COMPANY_CAR;
```

<br>

### 🔻 흉부외과 또는 일반외과 의사 목록 출력하기

```sql
SELECT 
    DR_NAME, 
    DR_ID, 
    MCDP_CD, 
    DATE_FORMAT(HIRE_YMD, '%Y-%m-%d') AS HIRE_YMD
FROM 
    DOCTOR
WHERE 
    MCDP_CD IN ('CS', 'GS')
ORDER BY 
    HIRE_YMD DESC, 
    DR_NAME ASC;
```


<br>

### 🔻 강원도에 위치한 생산공장 목록 출력하기

```sql
SELECT FF.FACTORY_ID, FF.FACTORY_NAME, FF.ADDRESS
FROM FOOD_FACTORY AS FF
WHERE FF.ADDRESS LIKE '강원도%'
ORDER BY FACTORY_ID ASC;
```
